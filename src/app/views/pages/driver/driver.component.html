<div class="mb-4">
    <h2>Conductores</h2>
    <p class="text-medium-emphasis">Lista de conductores del sistema</p>

    <div class="d-flex justify-content-end mb-3">
        <button cButton color="primary" size="sm" class="text-white" (click)="showClientsBlock()">
            Ver conductores {{ state === 1 ? 'bloqueados' : 'activos' }}
        </button>
    </div>
    <div class="table-responsive">
        <table cTable class="table align-middle">
            <thead cTableColor="dark">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Nombres</th>
                    <th scope="col">Correo</th>
                    <th scope="col">Teléfono</th>
                    <th scope="col">Fecha de creación</th>
                    <th scope="col">Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of dataDriver; let i = index">
                    <th scope="row">{{user?.id}}</th>
                    <td>{{user?.name}}</td>
                    <td>{{user?.email}}</td>
                    <td>{{user?.cellphone}}</td>
                    <td>{{user?.created | date: 'short'}}</td>
                    <td>
                        <button cButton color="success" size="sm" class="me-2 text-white" (click)="openDriverModal(i)">
                            Ver datos </button>

                        <button cButton [color]="user.state === true ? 'danger' : 'success'" size="sm"
                            class="me-2 text-white" (click)="blockUser(user.id)">
                            {{ user?.state === true ? 'Bloquear' : 'Desbloquear' }}
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div *ngIf="dataDriver.length === 0" class="alert alert-info" role="alert">
        No se encontraron conductores.
    </div>

    <nav class="mt-3" *ngIf="pageTotal > 1 && dataDriver.length > 0">
        <ul class="pagination justify-content-center">
            <li class="page-item" [class.disabled]="page === 1">
                <button class="page-link" (click)="changePage(page - 1)" [disabled]="page === 1">Anterior</button>
            </li>
            <li class="page-item" *ngFor="let p of [].constructor(pageTotal); let i = index"
                [class.active]="page === i + 1">
                <button class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</button>
            </li>
            <li class="page-item" [class.disabled]="page === pageTotal">
                <button class="page-link" (click)="changePage(page + 1)"
                    [disabled]="page === pageTotal">Siguiente</button>
            </li>
        </ul>
    </nav>
</div>

<c-modal [visible]="visibleDriverModal" (visibleChange)="visibleDriverModal = $event">
    <c-modal-header>
        <h5 cModalTitle>Datos del conductor</h5>
        <button cButtonClose (click)="closeDriverModal()"></button>
    </c-modal-header>
    <c-modal-body *ngIf="selectedDriver">
        <div class="row">
            <div class="col-6 mb-2">
                <strong>ID:</strong> {{ selectedDriver.id }}
            </div>
            <div class="col-6 mb-2">
                <strong>Nombre:</strong> {{ selectedDriver.name }}
            </div>
            <div class="col-6 mb-2">
                <strong>Apellido:</strong> {{ selectedDriver.lastname }}
            </div>
            <div class="col-6 mb-2">
                <strong>Correo:</strong> {{ selectedDriver.email }}
            </div>
            <div class="col-6 mb-2">
                <strong>Celular:</strong> {{ selectedDriver.cellphone }}
            </div>
            <div class="col-6 mb-2">
                <strong>Tipo documento:</strong> {{ selectedDriver.type_document }}
            </div>
            <div class="col-6 mb-2">
                <strong>N° documento:</strong> {{ selectedDriver.number_document }}
            </div>
            <div class="col-6 mb-2">
                <strong>Placa:</strong> {{ selectedDriver.number_plate }}
            </div>
            <div class="col-6 mb-2">
                <strong>Marca auto:</strong> {{ selectedDriver.brand_car }}
            </div>
            <div class="col-6 mb-2">
                <strong>Modelo auto:</strong> {{ selectedDriver.model_car }}
            </div>
            <div class="col-6 mb-2">
                <strong>Distrito:</strong> {{ selectedDriver.name_district }}
            </div>
            <div class="col-6 mb-2">
                <strong>Provincia:</strong> {{ selectedDriver.name_province }}
            </div>
            <div class="col-6 mb-2">
                <strong>Región:</strong> {{ selectedDriver.name_region }}
            </div>
            <div class="col-6 mb-2">
                <strong>Estado:</strong> {{ selectedDriver.state ? 'Activo' : 'Bloqueado' }}
            </div>
            <div class="col-6 mb-2">
                <strong>Creado:</strong> {{ selectedDriver.created | date:'short' }}
            </div>
            <div class="col-6 mb-2">
                <strong>Actualizado:</strong> {{ selectedDriver.updated | date:'short' }}
            </div>
        </div>
    </c-modal-body>
    <c-modal-footer>
        <button cButton color="secondary" (click)="closeDriverModal()">Cerrar</button>
    </c-modal-footer>
</c-modal>